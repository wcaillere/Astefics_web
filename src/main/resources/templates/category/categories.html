<!DOCTYPE html>
<html lang="fr" xmlns:th="http://www.thymeleaf.org">
<head th:replace="~{fragments/headfiles.html :: headfiles (title='Astefics - Catégories')}"></head>
<body>
<nav th:replace="~{fragments/navbar.html :: navbar}"></nav>
<div class="text-center mt-3" style="color: cornflowerblue">
    <h1 class="mt-4">Categories</h1>
</div>
<table class="table table-dark table-hover table-striped-columns m-auto mt-5" style="width: fit-content">
    <thead>
    <tr>
        <th class="align-middle text-center" scope="col">Id</th>
        <th class="align-middle text-center" scope="col">Nom</th>
        <th class="align-middle text-center" scope="col">Actions</th>
    </tr>
    </thead>
    <tbody>
    <tr th:each="category: ${categories}">
        <td class="align-middle text-center px-3" th:text="${category.id}"></td>
        <td class="align-middle text-center px-3" th:text="${category.name}"></td>
        <td class="align-middle text-center px-3 py-3">
            <a class="btn btn-primary mx-2"><i class="bi bi-card-text" style="margin-right: 6px"></i>Afficher
                Détails</a>
            <a class="btn btn-success mx-2" th:onclick="askNewName([[${category.id}]])"><i
                    class="bi bi-pencil" style="margin-right: 6px"></i>Modifier</a>
            <a class="btn btn-warning mx-2 text-danger" th:onclick="askConfirmationDelete([[${category.id}]])"><i
                    class="bi bi-trash" style="margin-right: 6px"></i>Supprimer</a>
        </td>
    </tr>
    </tbody>
</table>
<hr style="height: 20px; width: 40%; margin: auto; margin-top: 40px">
<form class="m-auto mt-4" method="post" style="width: 600px" th:action="@{/addCategory}" th:object="${category}">
    <h2 class="mb-3">Ajouter une catégorie</h2>
    <div class="mb-3">
        <label class="form-label">Nom</label>
        <input class="form-control" id="name" th:field="*{name}">
    </div>
    <button class="btn btn-primary" type="submit">Valider</button>
</form>

<script>
    function askConfirmationDelete(id) {
        if (confirm("Voulez vous vraiment supprimer cette catégorie ?")) {
            window.location.href = ("/deleteCategory/" + id)
        }
    }

    function askNewName(id) {
        let newName = prompt("Entrez le nouveau nom de la catégorie :");
        if (newName != null) {
            window.location.href = ("/modifyCategory/" + id + "/" + newName)
        }
    }
</script>
</body>
</html>